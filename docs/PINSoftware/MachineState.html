<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.8.4" />
<title>PINSoftware.MachineState API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>PINSoftware.MachineState</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import os
import shutil

from typing import List

import matplotlib.animation as animation

from PINSoftware.Debugger import Debugger
from PINSoftware.Profiler import Profiler
from PINSoftware.DataAnalyser import DataAnalyser
from PINSoftware.DataSaver import CsvDataSaver, Hdf5DataSaver, Filetype, SavingException
from PINSoftware.DataUpdater import NiDAQmxDataUpdater, LoadedDataUpdater

class MachineState():
    &#34;&#34;&#34;
    This is the main class covering all hardware control and data analysis (everything except the UI).
    There should always be only one instance at a time and the program keeps it for the whole duration
    of the run.
    &#34;&#34;&#34;
    def __init__(self, plt, dummy : bool, dummy_data_file : str, profiler : bool = False,
            plot_update_interval : int = 100, log_directory : str = &#34;logs&#34;):
        &#34;&#34;&#34;
        `plt` should be the `matplotlib.pyplot` module or something equivalent, this is for plotting the live
        data graph on the host machine when the graphing option is enabled.

        `dummy` determines whether the data should be grabbed from the NI-6002 or a dummy file. If `dummy` is
        True, `dummy_data_file` should be specified otherwise the program will crash.

        `dummy_data_file` is a path to the data to use for dummy mode.

        `profiler` is whether the DataUpdater should be profiled.

        `plot_update_interval` is the update interval of the live data graph.

        `log_directory` is the directory where to put saved data.
        &#34;&#34;&#34;
        self.plt = plt
        self.dummy = dummy
        self.dummy_data_file = dummy_data_file
        self.profiler = profiler
        self.plot_update_interval = plot_update_interval
        self.log_directory = os.path.join(os.path.curdir, log_directory)

        self.init_graph()

        self.debugger = Debugger()
        self.controller = None
        self.du = None
        self.data = None
        self.saver = None
        self.experiment_running = False

        if not os.path.exists(self.log_directory):
            os.mkdir(self.log_directory)

    def init_graph(self):
        &#34;&#34;&#34;Setup for the live graphing&#34;&#34;&#34;
        self.fig = self.plt.figure()
        self.ax = self.fig.add_subplot(1, 1, 1)

        self.pause = False

    def animate(self, i):
        &#34;&#34;&#34;The animate function for the `animation.FuncAnimation` class&#34;&#34;&#34;
        if not self.pause and self.du:
            if self.du.data:
                self.ax.clear()
                self.du.data.plot(self.plt)

    def onKeyPress(self, event):
        &#34;&#34;&#34;The function to call when a key is pressed in the live graph window&#34;&#34;&#34;
        if event.key == &#34;p&#34;:
            self.pause = not self.pause

    def run_graphing(self):
        &#34;&#34;&#34;This runs the actual graphing, this hangs until the window is closed&#34;&#34;&#34;
        self.ani = animation.FuncAnimation(self.fig, self.animate, interval=self.plot_update_interval)
        self.fig.canvas.mpl_connect(&#39;key_press_event&#39;, self.onKeyPress)
        self.plt.show()

    def grab_control(self, controller_sid):
        &#34;&#34;&#34;
        Wrapper around the `MachineState.controller` field where extra effects can be added,
        called when someone grabs control.
        &#34;&#34;&#34;
        self.controller = controller_sid
        self.stop_experiment()

    def release_control(self):
        &#34;&#34;&#34;
        Wrapper around the `MachineState.controller` field where extra effects can be added,
        called when the control is released.
        &#34;&#34;&#34;
        self.controller = None
        self.stop_experiment()

    def start_experiment(self, save_base_filename : str = None, save_filetype : Filetype = Filetype.Csv,
            items : List[str] = [&#34;ys&#34;,&#34;processed_ys&#34;], **kwargs):
        &#34;&#34;&#34;
        This starts a data acquisition run. It creates a new `PINSoftware.DataAnalyser.DataAnalyser` and an appropriate `DataUpdater`.
        Then it may also create and start a `DataSaver` and/or a `Profiler` based on the situation.

        `save_base_filename` is the base part of the filename for the new log file. The `save_base_filename`
        is appended with a timestamp and an appropriate file extension and that makes up the filename.

        `save_filetype` determines the `DataSaver` type, more information in `PINSoftware.DataSaver`.

        `items` is used when `save_filetype` is `PINSoftware.DataSaver.Filetype.Hdf5` and is passed to the
        `PINSoftware.DataSaver.Hdf5DataSaver`.

        `kwargs` are passed to the new `PINSoftware.DataAnalyser.DataAnalyser` instance.

        More information on how it all works look in the module documentation: `PINSoftware`.
        &#34;&#34;&#34;
        self.data = DataAnalyser(50000, plot_buffer_len=200, debugger=self.debugger, **kwargs)
        if save_base_filename:
            if save_filetype == Filetype.Csv:
                self.saver = CsvDataSaver(self.data, self.log_directory, save_base_filename)
            elif save_filetype == Filetype.Hdf5:
                self.saver = Hdf5DataSaver(self.data, self.log_directory, save_base_filename, items=items)
        else:
            self.saver = None
        if self.dummy:
            self.du = LoadedDataUpdater(self.dummy_data_file, self.data, freq=50000, debugger=self.debugger)
        else:
            self.du = NiDAQmxDataUpdater(self.data, debugger=self.debugger)
        if self.profiler:
            self.du.profiler = Profiler(name=&#34;DataUpdater RPS&#34;, start_delay=3)
        self.du.start()
        if self.saver:
            self.saver.start()
        self.experiment_running = True

    def stop_experiment(self):
        &#34;&#34;&#34;This stops the current experiment and all the threads working on it&#34;&#34;&#34;
        if self.du:
            self.du.stop()
        if self.saver:
            self.saver.stop()
        self.experiment_running = False

    def stop_everything(self):
        &#34;&#34;&#34;This currently just calls `stop_experiment` but there might be stuff added here,
        this is meant to be a sort of stop all button&#34;&#34;&#34;
        self.stop_experiment()

    def delete_logs(self):
        shutil.rmtree(self.log_directory)
        os.mkdir(self.log_directory)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="PINSoftware.MachineState.MachineState"><code class="flex name class">
<span>class <span class="ident">MachineState</span></span>
<span>(</span><span>plt, dummy: bool, dummy_data_file: str, profiler: bool = False, plot_update_interval: int = 100, log_directory: str = 'logs')</span>
</code></dt>
<dd>
<div class="desc"><p>This is the main class covering all hardware control and data analysis (everything except the UI).
There should always be only one instance at a time and the program keeps it for the whole duration
of the run.</p>
<p><code>plt</code> should be the <code>matplotlib.pyplot</code> module or something equivalent, this is for plotting the live
data graph on the host machine when the graphing option is enabled.</p>
<p><code>dummy</code> determines whether the data should be grabbed from the NI-6002 or a dummy file. If <code>dummy</code> is
True, <code>dummy_data_file</code> should be specified otherwise the program will crash.</p>
<p><code>dummy_data_file</code> is a path to the data to use for dummy mode.</p>
<p><code>profiler</code> is whether the DataUpdater should be profiled.</p>
<p><code>plot_update_interval</code> is the update interval of the live data graph.</p>
<p><code>log_directory</code> is the directory where to put saved data.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MachineState():
    &#34;&#34;&#34;
    This is the main class covering all hardware control and data analysis (everything except the UI).
    There should always be only one instance at a time and the program keeps it for the whole duration
    of the run.
    &#34;&#34;&#34;
    def __init__(self, plt, dummy : bool, dummy_data_file : str, profiler : bool = False,
            plot_update_interval : int = 100, log_directory : str = &#34;logs&#34;):
        &#34;&#34;&#34;
        `plt` should be the `matplotlib.pyplot` module or something equivalent, this is for plotting the live
        data graph on the host machine when the graphing option is enabled.

        `dummy` determines whether the data should be grabbed from the NI-6002 or a dummy file. If `dummy` is
        True, `dummy_data_file` should be specified otherwise the program will crash.

        `dummy_data_file` is a path to the data to use for dummy mode.

        `profiler` is whether the DataUpdater should be profiled.

        `plot_update_interval` is the update interval of the live data graph.

        `log_directory` is the directory where to put saved data.
        &#34;&#34;&#34;
        self.plt = plt
        self.dummy = dummy
        self.dummy_data_file = dummy_data_file
        self.profiler = profiler
        self.plot_update_interval = plot_update_interval
        self.log_directory = os.path.join(os.path.curdir, log_directory)

        self.init_graph()

        self.debugger = Debugger()
        self.controller = None
        self.du = None
        self.data = None
        self.saver = None
        self.experiment_running = False

        if not os.path.exists(self.log_directory):
            os.mkdir(self.log_directory)

    def init_graph(self):
        &#34;&#34;&#34;Setup for the live graphing&#34;&#34;&#34;
        self.fig = self.plt.figure()
        self.ax = self.fig.add_subplot(1, 1, 1)

        self.pause = False

    def animate(self, i):
        &#34;&#34;&#34;The animate function for the `animation.FuncAnimation` class&#34;&#34;&#34;
        if not self.pause and self.du:
            if self.du.data:
                self.ax.clear()
                self.du.data.plot(self.plt)

    def onKeyPress(self, event):
        &#34;&#34;&#34;The function to call when a key is pressed in the live graph window&#34;&#34;&#34;
        if event.key == &#34;p&#34;:
            self.pause = not self.pause

    def run_graphing(self):
        &#34;&#34;&#34;This runs the actual graphing, this hangs until the window is closed&#34;&#34;&#34;
        self.ani = animation.FuncAnimation(self.fig, self.animate, interval=self.plot_update_interval)
        self.fig.canvas.mpl_connect(&#39;key_press_event&#39;, self.onKeyPress)
        self.plt.show()

    def grab_control(self, controller_sid):
        &#34;&#34;&#34;
        Wrapper around the `MachineState.controller` field where extra effects can be added,
        called when someone grabs control.
        &#34;&#34;&#34;
        self.controller = controller_sid
        self.stop_experiment()

    def release_control(self):
        &#34;&#34;&#34;
        Wrapper around the `MachineState.controller` field where extra effects can be added,
        called when the control is released.
        &#34;&#34;&#34;
        self.controller = None
        self.stop_experiment()

    def start_experiment(self, save_base_filename : str = None, save_filetype : Filetype = Filetype.Csv,
            items : List[str] = [&#34;ys&#34;,&#34;processed_ys&#34;], **kwargs):
        &#34;&#34;&#34;
        This starts a data acquisition run. It creates a new `PINSoftware.DataAnalyser.DataAnalyser` and an appropriate `DataUpdater`.
        Then it may also create and start a `DataSaver` and/or a `Profiler` based on the situation.

        `save_base_filename` is the base part of the filename for the new log file. The `save_base_filename`
        is appended with a timestamp and an appropriate file extension and that makes up the filename.

        `save_filetype` determines the `DataSaver` type, more information in `PINSoftware.DataSaver`.

        `items` is used when `save_filetype` is `PINSoftware.DataSaver.Filetype.Hdf5` and is passed to the
        `PINSoftware.DataSaver.Hdf5DataSaver`.

        `kwargs` are passed to the new `PINSoftware.DataAnalyser.DataAnalyser` instance.

        More information on how it all works look in the module documentation: `PINSoftware`.
        &#34;&#34;&#34;
        self.data = DataAnalyser(50000, plot_buffer_len=200, debugger=self.debugger, **kwargs)
        if save_base_filename:
            if save_filetype == Filetype.Csv:
                self.saver = CsvDataSaver(self.data, self.log_directory, save_base_filename)
            elif save_filetype == Filetype.Hdf5:
                self.saver = Hdf5DataSaver(self.data, self.log_directory, save_base_filename, items=items)
        else:
            self.saver = None
        if self.dummy:
            self.du = LoadedDataUpdater(self.dummy_data_file, self.data, freq=50000, debugger=self.debugger)
        else:
            self.du = NiDAQmxDataUpdater(self.data, debugger=self.debugger)
        if self.profiler:
            self.du.profiler = Profiler(name=&#34;DataUpdater RPS&#34;, start_delay=3)
        self.du.start()
        if self.saver:
            self.saver.start()
        self.experiment_running = True

    def stop_experiment(self):
        &#34;&#34;&#34;This stops the current experiment and all the threads working on it&#34;&#34;&#34;
        if self.du:
            self.du.stop()
        if self.saver:
            self.saver.stop()
        self.experiment_running = False

    def stop_everything(self):
        &#34;&#34;&#34;This currently just calls `stop_experiment` but there might be stuff added here,
        this is meant to be a sort of stop all button&#34;&#34;&#34;
        self.stop_experiment()

    def delete_logs(self):
        shutil.rmtree(self.log_directory)
        os.mkdir(self.log_directory)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="PINSoftware.MachineState.MachineState.init_graph"><code class="name flex">
<span>def <span class="ident">init_graph</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Setup for the live graphing</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init_graph(self):
    &#34;&#34;&#34;Setup for the live graphing&#34;&#34;&#34;
    self.fig = self.plt.figure()
    self.ax = self.fig.add_subplot(1, 1, 1)

    self.pause = False</code></pre>
</details>
</dd>
<dt id="PINSoftware.MachineState.MachineState.animate"><code class="name flex">
<span>def <span class="ident">animate</span></span>(<span>self, i)</span>
</code></dt>
<dd>
<div class="desc"><p>The animate function for the <code>animation.FuncAnimation</code> class</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def animate(self, i):
    &#34;&#34;&#34;The animate function for the `animation.FuncAnimation` class&#34;&#34;&#34;
    if not self.pause and self.du:
        if self.du.data:
            self.ax.clear()
            self.du.data.plot(self.plt)</code></pre>
</details>
</dd>
<dt id="PINSoftware.MachineState.MachineState.onKeyPress"><code class="name flex">
<span>def <span class="ident">onKeyPress</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<div class="desc"><p>The function to call when a key is pressed in the live graph window</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def onKeyPress(self, event):
    &#34;&#34;&#34;The function to call when a key is pressed in the live graph window&#34;&#34;&#34;
    if event.key == &#34;p&#34;:
        self.pause = not self.pause</code></pre>
</details>
</dd>
<dt id="PINSoftware.MachineState.MachineState.run_graphing"><code class="name flex">
<span>def <span class="ident">run_graphing</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>This runs the actual graphing, this hangs until the window is closed</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_graphing(self):
    &#34;&#34;&#34;This runs the actual graphing, this hangs until the window is closed&#34;&#34;&#34;
    self.ani = animation.FuncAnimation(self.fig, self.animate, interval=self.plot_update_interval)
    self.fig.canvas.mpl_connect(&#39;key_press_event&#39;, self.onKeyPress)
    self.plt.show()</code></pre>
</details>
</dd>
<dt id="PINSoftware.MachineState.MachineState.grab_control"><code class="name flex">
<span>def <span class="ident">grab_control</span></span>(<span>self, controller_sid)</span>
</code></dt>
<dd>
<div class="desc"><p>Wrapper around the <code>MachineState.controller</code> field where extra effects can be added,
called when someone grabs control.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def grab_control(self, controller_sid):
    &#34;&#34;&#34;
    Wrapper around the `MachineState.controller` field where extra effects can be added,
    called when someone grabs control.
    &#34;&#34;&#34;
    self.controller = controller_sid
    self.stop_experiment()</code></pre>
</details>
</dd>
<dt id="PINSoftware.MachineState.MachineState.release_control"><code class="name flex">
<span>def <span class="ident">release_control</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Wrapper around the <code>MachineState.controller</code> field where extra effects can be added,
called when the control is released.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def release_control(self):
    &#34;&#34;&#34;
    Wrapper around the `MachineState.controller` field where extra effects can be added,
    called when the control is released.
    &#34;&#34;&#34;
    self.controller = None
    self.stop_experiment()</code></pre>
</details>
</dd>
<dt id="PINSoftware.MachineState.MachineState.start_experiment"><code class="name flex">
<span>def <span class="ident">start_experiment</span></span>(<span>self, save_base_filename: str = None, save_filetype: <a title="PINSoftware.DataSaver.Filetype" href="DataSaver.html#PINSoftware.DataSaver.Filetype">Filetype</a> = Filetype.Csv, items: List[str] = ['ys', 'processed_ys'], **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>This starts a data acquisition run. It creates a new <code><a title="PINSoftware.DataAnalyser.DataAnalyser" href="DataAnalyser.html#PINSoftware.DataAnalyser.DataAnalyser">DataAnalyser</a></code> and an appropriate <code>DataUpdater</code>.
Then it may also create and start a <code>DataSaver</code> and/or a <code>Profiler</code> based on the situation.</p>
<p><code>save_base_filename</code> is the base part of the filename for the new log file. The <code>save_base_filename</code>
is appended with a timestamp and an appropriate file extension and that makes up the filename.</p>
<p><code>save_filetype</code> determines the <code>DataSaver</code> type, more information in <code><a title="PINSoftware.DataSaver" href="DataSaver.html">PINSoftware.DataSaver</a></code>.</p>
<p><code>items</code> is used when <code>save_filetype</code> is <code><a title="PINSoftware.DataSaver.Filetype.Hdf5" href="DataSaver.html#PINSoftware.DataSaver.Filetype.Hdf5">Filetype.Hdf5</a></code> and is passed to the
<code><a title="PINSoftware.DataSaver.Hdf5DataSaver" href="DataSaver.html#PINSoftware.DataSaver.Hdf5DataSaver">Hdf5DataSaver</a></code>.</p>
<p><code>kwargs</code> are passed to the new <code><a title="PINSoftware.DataAnalyser.DataAnalyser" href="DataAnalyser.html#PINSoftware.DataAnalyser.DataAnalyser">DataAnalyser</a></code> instance.</p>
<p>More information on how it all works look in the module documentation: <code><a title="PINSoftware" href="index.html">PINSoftware</a></code>.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def start_experiment(self, save_base_filename : str = None, save_filetype : Filetype = Filetype.Csv,
        items : List[str] = [&#34;ys&#34;,&#34;processed_ys&#34;], **kwargs):
    &#34;&#34;&#34;
    This starts a data acquisition run. It creates a new `PINSoftware.DataAnalyser.DataAnalyser` and an appropriate `DataUpdater`.
    Then it may also create and start a `DataSaver` and/or a `Profiler` based on the situation.

    `save_base_filename` is the base part of the filename for the new log file. The `save_base_filename`
    is appended with a timestamp and an appropriate file extension and that makes up the filename.

    `save_filetype` determines the `DataSaver` type, more information in `PINSoftware.DataSaver`.

    `items` is used when `save_filetype` is `PINSoftware.DataSaver.Filetype.Hdf5` and is passed to the
    `PINSoftware.DataSaver.Hdf5DataSaver`.

    `kwargs` are passed to the new `PINSoftware.DataAnalyser.DataAnalyser` instance.

    More information on how it all works look in the module documentation: `PINSoftware`.
    &#34;&#34;&#34;
    self.data = DataAnalyser(50000, plot_buffer_len=200, debugger=self.debugger, **kwargs)
    if save_base_filename:
        if save_filetype == Filetype.Csv:
            self.saver = CsvDataSaver(self.data, self.log_directory, save_base_filename)
        elif save_filetype == Filetype.Hdf5:
            self.saver = Hdf5DataSaver(self.data, self.log_directory, save_base_filename, items=items)
    else:
        self.saver = None
    if self.dummy:
        self.du = LoadedDataUpdater(self.dummy_data_file, self.data, freq=50000, debugger=self.debugger)
    else:
        self.du = NiDAQmxDataUpdater(self.data, debugger=self.debugger)
    if self.profiler:
        self.du.profiler = Profiler(name=&#34;DataUpdater RPS&#34;, start_delay=3)
    self.du.start()
    if self.saver:
        self.saver.start()
    self.experiment_running = True</code></pre>
</details>
</dd>
<dt id="PINSoftware.MachineState.MachineState.stop_experiment"><code class="name flex">
<span>def <span class="ident">stop_experiment</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>This stops the current experiment and all the threads working on it</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def stop_experiment(self):
    &#34;&#34;&#34;This stops the current experiment and all the threads working on it&#34;&#34;&#34;
    if self.du:
        self.du.stop()
    if self.saver:
        self.saver.stop()
    self.experiment_running = False</code></pre>
</details>
</dd>
<dt id="PINSoftware.MachineState.MachineState.stop_everything"><code class="name flex">
<span>def <span class="ident">stop_everything</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>This currently just calls <code>stop_experiment</code> but there might be stuff added here,
this is meant to be a sort of stop all button</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def stop_everything(self):
    &#34;&#34;&#34;This currently just calls `stop_experiment` but there might be stuff added here,
    this is meant to be a sort of stop all button&#34;&#34;&#34;
    self.stop_experiment()</code></pre>
</details>
</dd>
<dt id="PINSoftware.MachineState.MachineState.delete_logs"><code class="name flex">
<span>def <span class="ident">delete_logs</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def delete_logs(self):
    shutil.rmtree(self.log_directory)
    os.mkdir(self.log_directory)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="PINSoftware" href="index.html">PINSoftware</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="PINSoftware.MachineState.MachineState" href="#PINSoftware.MachineState.MachineState">MachineState</a></code></h4>
<ul class="two-column">
<li><code><a title="PINSoftware.MachineState.MachineState.init_graph" href="#PINSoftware.MachineState.MachineState.init_graph">init_graph</a></code></li>
<li><code><a title="PINSoftware.MachineState.MachineState.animate" href="#PINSoftware.MachineState.MachineState.animate">animate</a></code></li>
<li><code><a title="PINSoftware.MachineState.MachineState.onKeyPress" href="#PINSoftware.MachineState.MachineState.onKeyPress">onKeyPress</a></code></li>
<li><code><a title="PINSoftware.MachineState.MachineState.run_graphing" href="#PINSoftware.MachineState.MachineState.run_graphing">run_graphing</a></code></li>
<li><code><a title="PINSoftware.MachineState.MachineState.grab_control" href="#PINSoftware.MachineState.MachineState.grab_control">grab_control</a></code></li>
<li><code><a title="PINSoftware.MachineState.MachineState.release_control" href="#PINSoftware.MachineState.MachineState.release_control">release_control</a></code></li>
<li><code><a title="PINSoftware.MachineState.MachineState.start_experiment" href="#PINSoftware.MachineState.MachineState.start_experiment">start_experiment</a></code></li>
<li><code><a title="PINSoftware.MachineState.MachineState.stop_experiment" href="#PINSoftware.MachineState.MachineState.stop_experiment">stop_experiment</a></code></li>
<li><code><a title="PINSoftware.MachineState.MachineState.stop_everything" href="#PINSoftware.MachineState.MachineState.stop_everything">stop_everything</a></code></li>
<li><code><a title="PINSoftware.MachineState.MachineState.delete_logs" href="#PINSoftware.MachineState.MachineState.delete_logs">delete_logs</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.8.4</a>.</p>
</footer>
</body>
</html>